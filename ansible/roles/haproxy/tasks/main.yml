---
- name: Include HAProxy installation task
  ansible.builtin.include_tasks: install.yml
  when: haproxy_state == "present"

- name: Include HAProxy uninstallation task
  ansible.builtin.include_tasks: uninstall.yml
  when: haproxy_state == "absent"

- name: Validate HAProxy state
  ansible.builtin.fail:
    msg: "Invalid haproxy_state. Must be 'present' or 'absent'"
  when: haproxy_state not in ['present', 'absent']